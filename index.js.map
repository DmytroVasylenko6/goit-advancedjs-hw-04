{"version":3,"file":"index.js","sources":["../src/js/load-more-btn.js","../src/js/pixabay-api.js","../src/js/render-functions.js","../src/main.js"],"sourcesContent":["export default class LoadMoreBtn {\n  constructor({ selector, hidden = false }) {\n    this.refs = this.getRefs(selector);\n\n    hidden && this.hide();\n  }\n\n  getRefs(selector) {\n    const refs = {};\n    refs.button = document.querySelector(selector);\n    refs.label = refs.button.querySelector('.label');\n    refs.spinner = refs.button.querySelector('.spinner');\n\n    return refs;\n  }\n\n  enable() {\n    this.refs.button.disabled = false;\n    this.refs.label.textContent = 'Load more';\n    this.refs.spinner.classList.add('is-hidden');\n  }\n\n  disable() {\n    this.refs.button.disabled = true;\n    this.refs.label.textContent = 'Loading...';\n    this.refs.spinner.classList.remove('is-hidden');\n  }\n\n  show() {\n    this.refs.button.classList.remove('is-hidden');\n  }\n\n  hide() {\n    this.refs.button.classList.add('is-hidden');\n  }\n}\n","import axios from 'axios';\n\nconst API_KEY = '19197868-48df692c0a14d7fda4172233f';\n\naxios.defaults.baseURL = 'https://pixabay.com/api';\n\nexport default class PicturesApiService {\n  constructor() {\n    this.searchQuery = '';\n    this.page = 1;\n  }\n\n  async fetchPictures() {\n    const { data } = await axios.get(\n      `/?image_type=photo&orientation=horizontal&q=${this.searchQuery}&page=${this.page}&per_page=12&key=${API_KEY}`\n    );\n\n    if (data.total === 0) {\n      throw 'Images not found';\n    }\n    this.page += 1;\n\n    return data.hits;\n  }\n\n  resetPage() {\n    this.page = 1;\n  }\n\n  get query() {\n    return this.searchQuery;\n  }\n  set query(newSearchQuery) {\n    this.searchQuery = newSearchQuery;\n  }\n}\n","export function renderCard(data) {\n  const {\n    webformatURL,\n    largeImageURL,\n    likes,\n    views,\n    comments,\n    downloads,\n    tags,\n  } = data;\n\n  return `<li class=\"photo-card\">\n    <a class=\"gallery__link\" href=\"${largeImageURL}\">\n      <img class=\"images\" src=\"${webformatURL}\" alt=\"${tags}\" height=\"200\" />\n    </a>\n    <div class=\"stats\">\n        <p class=\"stats-item\">\n            <i class=\"material-icons\">thumb_up</i>\n            ${likes}\n        </p>\n        <p class=\"stats-item\">\n            <i class=\"material-icons\">visibility</i>\n            ${views}\n        </p>\n        <p class=\"stats-item\">\n            <i class=\"material-icons\">comment</i>\n            ${comments}\n        </p>\n        <p class=\"stats-item\">\n            <i class=\"material-icons\">cloud_download</i>\n            ${downloads}\n        </p>\n    </div>\n</li>`;\n}\n","import LoadMoreBtn from './js/load-more-btn';\nimport PicturesApiService from './js/pixabay-api';\nimport { renderCard } from './js/render-functions';\nimport iziToast from 'izitoast';\nimport 'izitoast/dist/css/iziToast.min.css';\nimport SimpleLightbox from 'simplelightbox';\nimport 'simplelightbox/dist/simple-lightbox.min.css';\n\nconst refs = {\n  searchForm: document.querySelector('.search-form'),\n  gallery: document.querySelector('.gallery'),\n  galleryItem: document.querySelector('.photo-card'),\n};\n\nconst loadMoreBtn = new LoadMoreBtn({\n  selector: '[data-action=\"load-more\"]',\n  hidden: true,\n});\n\nrefs.searchForm.addEventListener('submit', onSearch);\nloadMoreBtn.refs.button.addEventListener('click', onLoadMore);\nrefs.gallery.addEventListener('click', onImageClick);\n\nfunction onImageClick(event) {\n  if (event.target.nodeName !== 'IMG') {\n    return;\n  }\n}\n\nconst picturesApiService = new PicturesApiService();\n\nfunction onSearch(e) {\n  e.preventDefault();\n  clearPictureGallery();\n  picturesApiService.query = e.currentTarget.elements.query.value.trim();\n\n  if (picturesApiService.query === '') {\n    loadMoreBtn.hide();\n    iziToast.show('Enter text!');\n  }\n\n  picturesApiService.resetPage();\n  fetchPictures();\n  loadMoreBtn.show();\n}\n\nfunction onLoadMore() {\n  const startTime = performance.now();\n  fetchPictures();\n  const endTime = performance.now();\n  const time = Math.floor(endTime - startTime) * 1000;\n  scroll(time);\n}\n\nfunction appendPicturesMarkup(pictures) {\n  const html = pictures.map(picture => {\n    return renderCard(picture);\n  });\n  refs.gallery.insertAdjacentHTML('beforeend', html.join(''));\n\n  new SimpleLightbox('.gallery a', {\n    caption: true,\n    captionsData: 'alt',\n    captionDelay: 250,\n  });\n}\n\nfunction clearPictureGallery() {\n  refs.gallery.innerHTML = '';\n}\n\nasync function fetchPictures() {\n  loadMoreBtn.disable();\n\n  try {\n    const pictures = await picturesApiService.fetchPictures();\n    appendPicturesMarkup(pictures);\n    loadMoreBtn.enable();\n  } catch (er) {\n    errors(er);\n    loadMoreBtn.hide();\n  }\n}\n\nfunction scroll(time) {\n  let i = refs.gallery.clientHeight;\n  setTimeout(() => {\n    window.scrollTo({ top: i, behavior: 'smooth' });\n  }, time);\n}\n\nfunction errors(er) {\n  if (er === 'Images not found') {\n    iziToast.show('Unfortunately nothing was found for this request');\n    return;\n  }\n\n  iziToast.show('Error! Failed to upload images');\n}\n"],"names":["LoadMoreBtn","selector","hidden","refs","API_KEY","axios","PicturesApiService","data","newSearchQuery","renderCard","webformatURL","largeImageURL","likes","views","comments","downloads","tags","loadMoreBtn","onSearch","onLoadMore","onImageClick","event","picturesApiService","clearPictureGallery","iziToast","fetchPictures","startTime","endTime","time","scroll","appendPicturesMarkup","pictures","html","picture","SimpleLightbox","er","errors","i"],"mappings":"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"}