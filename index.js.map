{"version":3,"file":"index.js","sources":["../src/js/load-more-btn.js","../src/js/pixabay-api.js","../src/js/render-functions.js","../src/js/errors.js","../src/main.js"],"sourcesContent":["export default class LoadMoreBtn {\n  constructor({ selector, hidden = false }) {\n    this.refs = this.getRefs(selector);\n\n    hidden && this.hide();\n  }\n\n  getRefs(selector) {\n    const refs = {};\n    refs.button = document.querySelector(selector);\n    refs.label = refs.button.querySelector('.label');\n    refs.spinner = refs.button.querySelector('.spinner');\n\n    return refs;\n  }\n\n  enable() {\n    this.refs.button.disabled = false;\n    this.refs.label.textContent = 'Load more';\n    this.refs.spinner.classList.add('is-hidden');\n  }\n\n  disable() {\n    this.refs.button.disabled = true;\n    this.refs.label.textContent = 'Loading...';\n    this.refs.spinner.classList.remove('is-hidden');\n  }\n\n  show() {\n    this.refs.button.classList.remove('is-hidden');\n  }\n\n  hide() {\n    this.refs.button.classList.add('is-hidden');\n  }\n}\n","import axios from 'axios';\n\nconst API_KEY = '19197868-48df692c0a14d7fda4172233f';\n\naxios.defaults.baseURL = 'https://pixabay.com/api';\n\nexport default class PicturesApiService {\n  constructor() {\n    this.searchQuery = '';\n    this.page = 1;\n  }\n\n  async fetchPictures() {\n    const { data } = await axios.get(\n      `/?image_type=photo&orientation=horizontal&q=${this.searchQuery}&page=${this.page}&per_page=20&&safesearch=true&key=${API_KEY}`\n    );\n\n    if (data.total === 0) {\n      throw 'Images not found';\n    }\n    this.page += 1;\n\n    return data;\n  }\n\n  resetPage() {\n    this.page = 1;\n  }\n\n  get query() {\n    return this.searchQuery;\n  }\n  set query(newSearchQuery) {\n    this.searchQuery = newSearchQuery;\n  }\n}\n","export function renderCard(data) {\n  const {\n    webformatURL,\n    largeImageURL,\n    likes,\n    views,\n    comments,\n    downloads,\n    tags,\n  } = data;\n\n  return `<li class=\"photo-card\">\n    <a class=\"gallery__link\" href=\"${largeImageURL}\">\n      <img class=\"images\" src=\"${webformatURL}\" alt=\"${tags}\" height=\"200\" />\n    </a>\n    <div class=\"stats\">\n        <p class=\"stats-item\">\n            <i class=\"material-icons\">thumb_up</i>\n            ${likes}\n        </p>\n        <p class=\"stats-item\">\n            <i class=\"material-icons\">visibility</i>\n            ${views}\n        </p>\n        <p class=\"stats-item\">\n            <i class=\"material-icons\">comment</i>\n            ${comments}\n        </p>\n        <p class=\"stats-item\">\n            <i class=\"material-icons\">cloud_download</i>\n            ${downloads}\n        </p>\n    </div>\n</li>`;\n}\n","import iziToast from 'izitoast';\nimport 'izitoast/dist/css/iziToast.min.css';\n\nexport default function errors(er) {\n  if (er === 'imagesNotFound') {\n    iziToast.show({\n      title: 'Error',\n      message:\n        'Sorry, there are no images matching your search query. Please try again!',\n      position: 'topCenter',\n      color: 'red',\n    });\n\n    return;\n  }\n\n  iziToast.show({\n    title: 'Error',\n    message: 'Error! Failed to upload images',\n    position: 'topCenter',\n    color: 'red',\n  });\n}\n","import LoadMoreBtn from './js/load-more-btn';\nimport PicturesApiService from './js/pixabay-api';\nimport { renderCard } from './js/render-functions';\nimport errors from './js/errors';\n\nimport iziToast from 'izitoast';\nimport 'izitoast/dist/css/iziToast.min.css';\n\nimport SimpleLightbox from 'simplelightbox';\nimport 'simplelightbox/dist/simple-lightbox.min.css';\n\nconst refs = {\n  searchForm: document.querySelector('.search-form'),\n  gallery: document.querySelector('.gallery'),\n  galleryItem: document.querySelector('.photo-card'),\n  bottomText: document.querySelector('#bottomText'),\n};\n\nconst loadMoreBtn = new LoadMoreBtn({\n  selector: '[data-action=\"load-more\"]',\n  hidden: true,\n});\n\nrefs.searchForm.addEventListener('submit', onSearch);\nloadMoreBtn.refs.button.addEventListener('click', onLoadMore);\nrefs.gallery.addEventListener('click', onImageClick);\n\nfunction onImageClick(event) {\n  if (event.target.nodeName !== 'IMG') {\n    return;\n  }\n}\n\nconst picturesApiService = new PicturesApiService();\n\nasync function onSearch(e) {\n  e.preventDefault();\n  clearPictureGallery();\n  picturesApiService.query = e.currentTarget.elements.query.value.trim();\n\n  if (picturesApiService.query === '') {\n    loadMoreBtn.hide();\n    iziToast.show({\n      title: 'Error',\n      message: 'Please enter text!',\n      position: 'topCenter',\n      color: 'red',\n    });\n    return;\n  }\n\n  picturesApiService.resetPage();\n  await fetchPictures();\n}\n\nasync function onLoadMore() {\n  await fetchPictures();\n  scrollPage();\n}\n\nfunction appendPicturesMarkup(pictures) {\n  const html = pictures.map(picture => {\n    return renderCard(picture);\n  });\n  refs.gallery.insertAdjacentHTML('beforeend', html.join(''));\n\n  const lightbox = new SimpleLightbox('.gallery a', {\n    caption: true,\n    captionsData: 'alt',\n    captionDelay: 250,\n  });\n\n  lightbox.refresh();\n}\n\nfunction clearPictureGallery() {\n  refs.gallery.innerHTML = '';\n  bottomText.classList.add('hidden');\n}\n\nasync function fetchPictures() {\n  loadMoreBtn.disable();\n\n  try {\n    const { hits, totalHits } = await picturesApiService.fetchPictures();\n\n    const displayedPicturesCount = refs.gallery.children.length;\n\n    if (displayedPicturesCount >= totalHits) {\n      loadMoreBtn.hide();\n      bottomText.classList.remove('hidden');\n      iziToast.show({\n        title: 'Info',\n        message: \"We're sorry, but you've reached the end of search results.\",\n        position: 'topCenter',\n        color: 'blue',\n      });\n      return;\n    }\n    appendPicturesMarkup(hits);\n    loadMoreBtn.show();\n    loadMoreBtn.enable();\n  } catch (er) {\n    errors(er);\n    loadMoreBtn.hide();\n  }\n}\n\nfunction scrollPage() {\n  const card = document.querySelector('.photo-card');\n\n  if (card) {\n    const cardHeight = card.getBoundingClientRect().height;\n    window.scrollBy({\n      top: cardHeight * 2,\n      behavior: 'smooth',\n    });\n  }\n}\n"],"names":["LoadMoreBtn","selector","hidden","refs","API_KEY","axios","PicturesApiService","data","newSearchQuery","renderCard","webformatURL","largeImageURL","likes","views","comments","downloads","tags","errors","er","iziToast","loadMoreBtn","onSearch","onLoadMore","onImageClick","event","picturesApiService","clearPictureGallery","fetchPictures","scrollPage","appendPicturesMarkup","pictures","html","picture","SimpleLightbox","hits","totalHits","card","cardHeight"],"mappings":"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"}